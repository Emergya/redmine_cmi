<tr>
  <th rowspan=13><%= l('cmi.label_cost') %></th>
  <th rowspan="4"><%= l('cmi.label_done') %></th>
  <td><%= l('cmi.label_HHRR') %></td>
  <% @metrics.drop(1).each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_hhrr_spent_#{i}", :class => "issue" do -%>
      <%#= currency (metric.hhrr_cost_incurred - @metrics[i].hhrr_cost_incurred) %>
      <%= currency metric.hhrr_cost_incurred %>
    <% end -%>
  <% end -%>
</tr>
<tr>
  <td><%= l('cmi.label_others') %></td>
  <% @metrics.drop(1).each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_other_spent_#{i}", :class => "issue" do -%>
      <%#= currency (metric.material_cost_incurred - @metrics[i].material_cost_incurred) %>
      <% logger.info metric.inspect %>
      <%= currency metric.material_cost_incurred_year(@metrics[i].checkpoint.checkpoint_date.to_date.year) %>
    <% end -%>
  <% end -%>
</tr>
<tr>
  <td><%= l('cmi.label_bpo') %></td>
  <% @metrics.drop(1).each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_bpo_spent_#{i}", :class => "issue" do -%>
      <%#= currency (metric.bpo_cost_incurred - @metrics[i].bpo_cost_incurred) %>
      <%= currency metric.bpo_cost_incurred %>
    <% end -%>
  <% end -%>
</tr>
<tr>
  <td><%= l(:label_total) %></td>
  <% @metrics.drop(1).each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_total_spent_#{i}", :class => "issue" do -%>
      <%#= currency (metric.total_cost_incurred - @metrics[i].total_cost_incurred) %>
      <%= currency metric.total_cost_incurred %>
    <% end -%>
  <% end -%>
</tr>
<tr>
  <th rowspan=4><%= l('cmi.label_remaining') %></th>
  <td><%= l('cmi.label_HHRR') %></td>
  <% @metrics.drop(1).each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_hhrr_remaining_#{i}", :class => "issue" do -%>
      <%#= currency (metric.hhrr_cost_remaining - @metrics[i].hhrr_cost_remaining) %>
      <%= currency metric.hhrr_cost_remaining %>
    <% end -%>
  <% end -%>
</tr>
<tr>
  <td><%= l('cmi.label_others') %></td>
  <% @metrics.drop(1).each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_other_remaining_#{i}", :class => "issue" do -%>
      <%#= currency (metric.material_cost_remaining - @metrics[i].material_cost_remaining) %>
      <%= currency metric.material_cost_remaining %>
    <% end -%>
  <% end -%>
</tr>
<tr>
  <td><%= l('cmi.label_bpo') %></td>
  <% @metrics.drop(1).each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_bpo_remaining_#{i}", :class => "issue" do -%>
      <%#= currency (metric.bpo_cost_remaining - @metrics[i].bpo_cost_remaining) %>
      <%= currency metric.bpo_cost_remaining %>
    <% end -%>
  <% end -%>
</tr>
<tr>
   <td><%= l(:label_total) %></td>
   <% @metrics.drop(1).each_with_index do |metric, i| -%>
     <%= content_tag :td, :id => "cost_total_remaining_#{i}", :class => "issue" do -%>
       <%#= currency (metric.total_cost_remaining - @metrics[i].total_cost_remaining) %>
       <%= currency metric.total_cost_remaining %>
     <% end -%>
   <% end -%>
</tr>

<tr>
  <th rowspan=4><%= l('cmi.label_planned') %></th>
  <td><%= l('cmi.label_HHRR') %></td>
  <% @metrics.drop(1).each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_hhrr_planned_#{i}", :class => "issue" do -%>
      <%#= currency (metric.hhrr_cost_scheduled - @metrics[i].hhrr_cost_scheduled) %>
      <%= currency metric.hhrr_cost_scheduled %>
    <% end -%>
  <% end -%>
</tr>
<tr>
   <td><%= l('cmi.label_others') %></td>
   <% @metrics.drop(1).each_with_index do |metric, i| -%>
     <%= content_tag :td, :id => "cost_other_planned_#{i}", :class => "issue" do -%>
       <%= currency metric.material_cost_scheduled_year(@metrics[i].checkpoint.checkpoint_date.to_date.year) %>
       <%#= currency (metric.material_cost_scheduled - @metrics[i].material_cost_scheduled) %>
     <% end -%>
   <% end -%>
</tr>
<tr>
   <td><%= l('cmi.label_bpo') %></td>
   <% @metrics.drop(1).each_with_index do |metric, i| -%>
     <%= content_tag :td, :id => "cost_bpo_planned_#{i}", :class => "issue" do -%>
       <%= currency metric.bpo_cost_scheduled %>
       <%#= currency (metric.bpo_cost_scheduled - @metrics[i].bpo_cost_scheduled) %>
     <% end -%>
   <% end -%>
</tr>
<tr>
   <td><%= l(:label_total) %></td>
   <% @metrics.drop(1).each_with_index do |metric, i| -%>
     <%= content_tag :td, :id => "cost_total_planned_#{i}", :class => "issue" do -%>
       <%= currency metric.total_cost_scheduled_year(@metrics[i].checkpoint.checkpoint_date.to_date.year) %>
       <%#= currency (metric.total_cost_scheduled - @metrics[i].total_cost_scheduled) %>
     <% end -%>
   <% end -%>
</tr>
<tr>
  <th colspan="2"><%= l('cmi.label_graphs') %></th>
  <% @metrics.drop(1).each_with_index do |metric, i| -%>
    <%= content_tag :td, :id => "cost_chart_#{i}", :class => "issue" do -%>
      <img src="http://chart.apis.google.com/chart?cht=bhs&chd=t:<%= metric.hhrr_cost_percent_incurred.round(2) %>,<%= metric.material_cost_percent_incurred.round(2) %>,<%= metric.bpo_cost_percent_incurred.round(2) %>,<%= metric.total_cost_percent_incurred.round(2) %>|100,100,100&chco=4D89F9,C6D9FD&chbh=10,5,10&chs=250x90&chxt=x,y&chxl=0:|0|50|100|1:|<%=l :label_total %>: <%= percent metric.total_cost_percent_incurred %>|<%=l :'cmi.label_bpo' %>: <%= percent metric.bpo_cost_percent_incurred %>|<%=l :'cmi.label_others' %>: <%= percent metric.material_cost_percent_incurred %>|<%=l :'cmi.label_HHRR' %>: <%= percent metric.hhrr_cost_percent_incurred %>|"/>
      <img src="http://chart.apis.google.com/chart?cht=p3&chd=t:<%= metric.hhrr_cost_percent.round(2) %>,<%= metric.material_cost_percent.round(2) %>,<%= metric.bpo_cost_percent.round(2) %>&chs=250x50&chl=<%=l :'cmi.label_HHRR' %>: <%= percent metric.hhrr_cost_percent %>|<%=l :'cmi.label_others' %>: <%= percent metric.material_cost_percent %>|<%=l :'cmi.label_bpo' %>: <%= percent metric.bpo_cost_percent %>|"/>
    <% end -%>
  <% end -%>
</tr>
